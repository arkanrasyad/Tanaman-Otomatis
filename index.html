<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Kontrol Lampu MQTT</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
  <div class="bg-white shadow p-6 rounded text-center">
    <h1 class="text-2xl font-bold mb-4">Kontrol Lampu MQTT</h1>
    <button id="btnLampu" class="bg-gray-600 text-white px-4 py-2 rounded" onclick="toggleLampu()">Nyalakan</button>
  </div>

  <script>
    const client = mqtt.connect("wss://broker.hivemq.com:8884/mqtt");
    const topic = "tanaman/esp/lampu";
    let lampuNyala = false;

    client.on("connect", () => {
      console.log("Terhubung ke broker HiveMQ");
    });

    function toggleLampu() {
      const btn = document.getElementById("btnLampu");
      lampuNyala = !lampuNyala;
      const pesan = lampuNyala ? "on" : "off";
      client.publish(topic, pesan);
      btn.innerText = lampuNyala ? "Matikan" : "Nyalakan";
      btn.classList.toggle("bg-gray-600");
      btn.classList.toggle("bg-green-500");
    }
  </script>
</body>
</html>
